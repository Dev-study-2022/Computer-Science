# 프로세스와 스레드
<pre>
프로세스: 메모리 상에서 실행중인 프로그램
스레드: 프로세스 내에서 실제로 작업을 수행하는 주체
</pre>

### 프로세스
❗프로세스는 최소 1개의 스레드를 가지고 있음 (메인 스레드 포함)
![img.png](../resource/process_and_thread.png)
**프로세스는 각각 `별도의 주소공간을 할당`받는다. (독립적으로 이뤄짐)**
- Code: 코드 자체를 구성하는 메모리 영역 (프로그램 명령)
- Data: 전역변수(global), 정적변수(static), 배열(array), 구조체(structure) 등
    - 초기화 된 데이터는 data 영역에 저장
    - 초기화 되지 않은 데이터는 bss(block stated symbol) 영역에 저장
      <pre>❓ 두 영역을 구분하는 이유: 초기화 되지 않은 변수는 프로그램이 실행될 때 영역을 잡아주면 됨,
          값을 프로그램에 저장해 둘 필요는 없어. 그런데 초기화 된 변수는 값을 처음에 프로그램에 저장해놔야 
          하기 때문에 영역을 구분하는 것. bss영역 변수들이 많아져도 프로그램의 실행코드 사이즈가 늘어나지 않음
      </pre>
            
- Heap: 동적 할당 시 사용 (new(), malloc() 등)
- Stack: 지역변수, 매개변수, 리턴 값 (임시 메모리 영역) 
  
#### 멀티 프로세스   
> 하나의 프로그램을 여러개의 프로세스로 구성    
> => 여러 프로세스들이 병렬적으로 작업을 수행

**장점**
1. 안전성 (메모리 침범 문제를 OS 차원에서 해결) 
2. 한 프로세스에 문제가 생겨도 다른 프로세스들에 영향을 주지 않음.

**단점**
1. 각각 독립된 메모리 영역을 가지고 있어, 작업량이 많을 수록 오버헤드 발생.      
         => Context Switching으로 인한 성능 저하 발생
2. 프로세스 간의 복잡한 통신 (IPC)가 필요

#### Context Switching이란?
프로세스의 상태 정보를 저장하고 복원하는 일련의 과정    

즉, 동작 중인 프로세스가 대기하면서 해당 프로세스의 상태를 보관하고, 대기하고 있던 다음 순번의 프로세스가 동작하면서      
이전에 보관했던(자신의) 프로세스 상태를 복구하는 과정을 말함 

➡️프로세스는 각 메모리 영역을 할당받아 사용되므로, 캐시 메모리 초기화와 같은 무거운 작업이 진행되었을 때        
오버헤드가 발생할 문제가 존재

### 스레드
스레드는 프로세스 내애서 Stack만 따로 할당 받고 `나머지 영역은 서로 공유`한다.        
하나의 프로세스가 생성될 때, 기본적으로 하나의 스레드가 같이 생성됨.
#### 멀티 스레드
> 하나의 응용 프로그램에서 여러 스레드를 구성해 각 스레드가 하나의 작업을 처리하는 것

스레드들이 공유 메모리를 통해 다수의 작업을 동시에 처리하도록 해줌       

**장점**      
1. 독립적인 프로세스에 비해 공유 메모리만큼의 시간, 자원 손실이 감소.      
2. 전역 변수와 정적 변수에 대한 자료 공유 가능

**단점**: 스레드들은 공유 메모리를 갖기 때문에 하나의 스레드가 데이터 공간을 망가뜨리면 모든 스레드가 작동 불능 상태가 됨

멀티 스레드의 안전성에 대한 단점은 `Critical Section(임계 영역) 기법`을 통해 대비함     

**Critical Section(임계 영역) 기법**
> Critical Section(임계 영역): 접근해서는 안되는 공유 자원(파일, 입출력, 공유 데이터 등) 을 접근하는 명령문 또는 코드의 일부 영역

하나의 스레드가 공유 데이터 값을 변경하는 시점에 다른 스레드가 그 값을 읽으려할 때 발생하는 문제를 해결하기 위한 동기화 과정
> 상호 배제, 진행, 한정된 대기를 충족해야 함
